{% extends 'dashAdminReclam.html.twig' %}
{% block body %}
<div class="container">
    <div class="container">
        <h1 class="text-center">Reclamation Table</h1>

        <form action="{{ path('app_dashboard_reclamation') }}" method="get">
            <div class="form-group">
                <!-- Champ de recherche par nom, prénom ou email -->
                <div class="input-group mb-2">
                    <input type="text" class="form-control" name="q" placeholder="Search by First Name, Last Name or email" value="{{ app.request.query.get('q') }}">
                    <div class="input-group-append">
                        <button type="submit" class="btn btn-primary">Search</button>
                    </div>
                </div>
            </div>
        </form>

        <form action="{{ path('app_dashboard_reclamation') }}" method="get">
            <div class="form-group">
                <!-- Menu déroulant pour filtrer par type de réclamation -->
                <div class="input-group mb-2">
                    <select name="type" class="form-control">
                        <option value="">All</option>
                        <option value="arnaque" {% if app.request.query.get('type') == 'arnaque' %} selected {% endif %}>arnaque</option>
                        <option value="conflit" {% if app.request.query.get('type') == 'conflit' %} selected {% endif %}>conflit</option>
                        <!-- Ajoutez d'autres options de type de réclamation si nécessaire -->
                    </select>
                    <div class="input-group-append">
                        <button type="submit" class="btn btn-primary">Filter</button>
                    </div>
                </div>
            </div>
        </form>

        <form action="{{ path('app_dashboard_reclamation') }}" method="get">
            <div class="form-group">
                <!-- Menu déroulant pour trier par date -->
                <div class="input-group mb-2">
                    <select name="sort" class="form-control">
                        <option value="asc" {% if app.request.query.get('sort') == 'asc' %} selected {% endif %}>Ascending</option>
                        <option value="desc" {% if app.request.query.get('sort') == 'desc' %} selected {% endif %}>Descending</option>
                    </select>
                    <div class="input-group-append">
                        <button type="submit" class="btn btn-primary">Sort by Date</button>
                    </div>
                </div>
            </div>
        </form>
    </div>
  
  <div class="table-responsive">
			<table class="table table-bordered table-striped">
				<thead class="thead-dark">
					<tr>
						<th>Last Name
						</th>
						<th>First Name
						</th>
						<th>Email
						</th>
						<th>Date
						</th>
						<th>Type
						</th>
						<th>Status
						</th>

						<th>Action</th>
					</tr>
				</thead>
				<tbody>
			
				
					{% for reclamation in tableauReclamations %}
						<tr>
							 <td>{{ reclamation.getReclamateur().nom }}</td> 
							 <td>{{ reclamation.getReclamateur().prenom }}</td> 
							 <td>{{ reclamation.getReclamateur().email }}</td> 
							<td>{{ reclamation.dateReclamation|date('Y-m-d H:i:s') }}</td>
							<td>{{ reclamation.getType() }}</td>
							<td>{{ reclamation.statutReclamation }}</td>
							<td>
								<div class="d-flex justify-content-center">
                                   
                                    {% if reclamation.reponse is null %}
									<a href="{{ path('app_reclamation_show_and_add_response', {'reclamateur_id':reclamation.getReclamateur().id,'id': reclamation.id }) }}" class="btn btn-primary mx-2">Add Response</a>
                                    {% endif %}
									{# <a href="{{ path('app_reclamation_show_admin', {'reclamateur_id': user.id ,'id': reclamation.id}) }}" class="btn btn-info mx-2">Voir Détails</a>   #}


									{% if reclamation.reponse is not null %}

										{# ken famch reponse ala reclamation afmin ma ynajmch yaaml lee supp le modifier repnse #}

										<a href="{{ path('app_reponse_admin_show', {'reclamateur_id':  reclamation.getReclamateur().getId(), 'id': reclamation.reponse.getId()}) }}" class="btn btn-secondary mx-2">Show Response</a>

										{% if not reclamation.reponse.vu %}

											<a href="{{ path('app_reponse_edit', {'reclamateur_id':reclamation.getReclamateur().id, 'id': reclamation.reponse.id}) }}" class="btn btn-warning mx-2">Edit Response</a>

											<a href="{{ path('app_delete_reponse', {'id': reclamation.reponse.id}) }}" class="btn btn-danger mx-2" onclick="return confirm('Are you sure you want to delete this response?')">Delete Response</a>

										{% endif %}
										{# <a href="{{ path('app_delete_reponse', {'id': reclamation.reponse.id}) }}" class="btn btn-danger mx-2" onclick="return confirm('Êtes-vous sûr de vouloir supprimer cette réponse ?')">Supprimer Réponse</a>  #}

									{# {% else %} #}

										{# <span class="text-muted">Pas de réponse</span> #}

									{% endif %}

								</div>
							</td>
						</tr>
					{% endfor %}
				
				</tbody>
			</table>
			    {#start Pagination#}
             <div class="d-flex justify-content-center">
             {% do tableauReclamations.setPageRange(2) %}
             {{knp_pagination_render(tableauReclamations,'backoffice/reclamation/pagination.html.twig')}}
             </div>
						{#end Pagination#}
		</div>
		

	</div>
{% endblock %}

